# 🐉 Lore V3 - AI Dungeon Master Toolkit

**Lore V3** is an interactive, AI-powered Dungeons & Dragons assistant that uses a local LLM (via Ollama), a structured relational database, and a vector store to drive immersive storytelling, lore persistence, and dynamic character interaction.

---

## 📦 Project Structure

```
lore.v3/
├── db/                   # Tortoise ORM models and init logic
├── utils/                # Game utilities (character creation, LLM, retriever, prompts)
├── scripts/              # Utility scripts (verification, inspection)
├── main.py               # Main game loop
├── requirements.txt
├── world.db              # SQLite relational database
├── .chroma/              # Chroma vector store directory
└── README.md
```

---

## 🚀 Getting Started

### 1. Set up your environment

```bash
python -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
```

Make sure you have [Ollama](https://ollama.com) installed and running with the `mistral` model pulled:

```bash
ollama pull mistral
```

### 2. Seed your world

Use the included database seeding script to generate a default world with lore and locations:

```bash
python -m db.init_db
```

This will populate `world.db` and create the Chroma vector store in `.chroma/`.

---

## 🧠 Inspecting the Vectorstore

To examine the current contents of your Chroma vector store (i.e., lore embedded into the LLM):

```bash
python -m scripts.inspect_vectorstore
```

This will list stored documents and metadata to confirm embeddings are synced with your world database.

---

## 🔍 Verifying Characters

To verify all characters — and confirm they exist both in the vectorstore (LLM) and SQL database:

```bash
python -m scripts.verify_characters
```

This will:

- List each character
- Indicate whether they are player-controlled or NPC
- Show whether they're present in both the LLM and the database

---

## 🎮 Running the Game

Start the main game loop:

```bash
python main.py
```

Features:

- Select or create a player and a character
- Ask questions or take actions (`You:` prompt)
- Quit at any time with `quit`, `exit`, or `Ctrl+C`

---

## ⚙️ Development Notes

- All characters generated by the LLM are considered NPCs (no player relationship).
- Player-created characters are linked to their player.
- The retriever (`utils/retrieval.py`) loads the Chroma vector store — no re-embedding occurs unless new content is added.
- Use `add_doc()` from `retrieval.py` if you want to manually add new lore to the vector store.

---

## 📚 Future Improvements

- Lore editor GUI
- LLM summarization for long-running campaigns
- Session logging and export
- Voice support

---

Made with 🧙‍♂️ by Cameron Jeffries.
